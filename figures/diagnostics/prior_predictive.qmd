---
title: "TITLE"
format:
  pdf:
    fig-width: 12
    fig-height: 14
knitr:
  opts_knit:
    root.dir: "home/icrichmond/erica-490"
---

Authors: Erica Padvaiskas^1, Isabella C. Richmond^1, Carly D. Ziter^1^\*

1 Department of Biology, Concordia University, Montreal Canada, H4B 1R6

\* carly.ziter@concordia.ca 

```{r, echo=FALSE, eval=TRUE, warning=FALSE, message=FALSE}
source('R/packages.R')

prior_model_list <- tar_read(prior_model_list)


plot_prior <- function(mod, xmin, xmax){
  
  # how to sequence data
  seq_d <- seq(xmin, xmax, by = 0.5)
  
  # pull variables from model 
  vars <- colnames(mod$data)[-1]
  
  # identify categorical variables 
  factors <- names(Filter(is.factor,mod$data[-1]))
  
  # identify numeric variables 
  numeric <- names(Filter(is.numeric,mod$data[-1]))
  
  figlist <- lapply(numeric, function(x){
    
    df <- data.frame(matrix(ncol=length(vars),nrow=0, dimnames=list(NULL, vars)))
    
    df %<>%
      summarise_at(x, ~seq_d) %>%
      bind_rows(df, .) %>%
      mutate(across(all_of(factors), as.factor)) %>% 
      mutate(across(all_of(numeric), ~ replace(., is.na(.), 0)))
    
    epred <- add_epred_draws(df, mod)
    
    ggplot(epred, aes(x = get(x), y = .epred)) +
      geom_line(aes(group = .draw), alpha = 0.1) +
      labs(y = "Predicted Temperature", x = x) +
      theme_classic()
    
  })
}
```

## Prior Predictive Checks

Prior predictive checks are used to ensure that the values selected for priors for our models allow a biologically reasonable range of values. For models with fixed effects fit to the model, we simulate predictive draws for prior only models and visualize the slope/intercept of the values. We then do a "posterior predictive check" but with the prior only model, to see if the data is captured in the priors.

## Model 1: Species Richness

```{r, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
mod <- prior_model_list['SR']
figs <- plot_prior(mod[[1]], -3, 3)
do.call(grid.arrange, figs)
plot(pp_check(mod[[1]], ndraws = 100))
```

## Model 2: Shannon Diversity

```{r, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
mod <- prior_model_list['Shannon']
figs <- plot_prior(mod[[1]], -3, 3)
do.call(grid.arrange, figs)
plot(pp_check(mod[[1]], ndraws = 100))
```

## Model 3: Vegetative Complexity

```{r, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
mod <- prior_model_list['Complexity']
figs <- plot_prior(mod[[1]], -3, 3)
do.call(grid.arrange, figs)
plot(pp_check(mod[[1]], ndraws = 100))
```

## Model 4: Proportion of Invasive Species

```{r, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
mod <- prior_model_list['Invasive_Species']
figs <- plot_prior(mod[[1]], -3, 3)
do.call(grid.arrange, figs)
plot(pp_check(mod[[1]], ndraws = 100))
```

## Model 5: Proportion of Invasive Stems

```{r, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
mod <- prior_model_list['Invasive_Stems']
figs <- plot_prior(mod[[1]], -3, 3)
do.call(grid.arrange, figs)
plot(pp_check(mod[[1]], ndraws = 100))
```